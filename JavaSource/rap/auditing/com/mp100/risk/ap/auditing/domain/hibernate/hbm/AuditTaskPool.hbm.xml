<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- 
    Mapping file autogenerated by MyEclipse Persistence Tools
-->
<hibernate-mapping package="com.mp100.risk.ap.auditing.domain.hibernate.hbm">
    <class name="AuditTaskPool" table="X_AP_PEND_TASK_POOL">
        <comment>待审核任务池表</comment>
          <id name="auditTaskId" type="java.lang.String">
            <column name="AUDIT_TASK_ID" length="32">
            	<comment>审核任务标识</comment>
            </column>
        </id>
        
        <property name="createTime" type="java.util.Date">
            <column name="CREATE_TIME" length="7">
                <comment>创建时间</comment>
            </column>
        </property>
        
        <property name="membersId" type="java.lang.String">
            <column name="MEMBERS_ID" length="32">
                <comment>成员标识</comment>
            </column>
        </property>
        
        
        <property name="isLock" type="java.lang.String">
            <column name="IS_LOCK" length="2">
                <comment>是否锁住</comment>
            </column>
        </property>
        
        <property name="lockTime" type="java.util.Date">
            <column name="LOCK_TIME" length="7">
                <comment>锁定时间</comment>
            </column>
        </property>
    </class>
       
        <!-- 查询总任务 -->
	    <sql-query name="com.mp100.risk.ap.auditing.domain.hibernate.hbm.querySumTaskDV">
	       <return alias="AuditTaskPool" class="com.mp100.risk.ap.auditing.domain.hibernate.hbm.AuditTaskPool"></return>
	     <![CDATA[
				 select 
					      sys_guid() AUDIT_TASK_ID,
					      '' CREATE_TIME,
					      count(p.MEMBERS_ID) as MEMBERS_ID,
					      '' IS_LOCK,
                		  '' LOCK_TIME
				from
					      x_ap_members m,x_ap_pend_task_pool p
				where 
					      p.MEMBERS_ID = m.MEMBERS_ID
	      ]]>
	    </sql-query>
	    
	    <!-- 查询当天当前登录的成员的所有任务 -->
	    <sql-query name="com.mp100.risk.ap.auditing.domain.hibernate.hbm.queryMembersSumTaskDV">
	       <return alias="AuditTaskPool" class="com.mp100.risk.ap.auditing.domain.hibernate.hbm.AuditTaskPool"></return>
	     <![CDATA[
				select 
					      sys_guid() AUDIT_TASK_ID,
					      '' CREATE_TIME,
					      p.MEMBERS_ID,
					      count(p.MEMBERS_ID) as IS_LOCK,
                		  '' LOCK_TIME
				from
					      x_ap_members m,x_ap_pend_task_pool p
				where 
					     
					      p.MEMBERS_ID = m.MEMBERS_ID
                		  and (p.MEMBERS_ID like :QT_membersId or  :QT_membersId is null)
					      and ((to_char(p.CREATE_TIME,'yyyy-mm-dd')) = (to_char(sysdate,'yyyy-mm-dd')))
        		group by 
        				  p.MEMBERS_ID	      
	      ]]>
	    </sql-query>
	    
	    <!-- 查询当天所有成员的所有任务 -->
	    <sql-query name="com.mp100.risk.ap.auditing.domain.hibernate.hbm.queryMembersTotalTaskDV">
	       <return alias="AuditTaskPool" class="com.mp100.risk.ap.auditing.domain.hibernate.hbm.AuditTaskPool"></return>
	     <![CDATA[
				select 
					      p.AUDIT_TASK_ID,
					      p.CREATE_TIME,
					      p.MEMBERS_ID,
					      p.IS_LOCK,
                		  p.LOCK_TIME
				from
					      x_ap_members m,x_ap_pend_task_pool p
				where 
					      p.MEMBERS_ID = m.MEMBERS_ID
	      ]]>
	    </sql-query>
</hibernate-mapping>
