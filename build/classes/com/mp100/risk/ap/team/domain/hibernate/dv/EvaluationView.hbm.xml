<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- 
    Mapping file autogenerated by MyEclipse Persistence Tools
-->
<hibernate-mapping package="com.mp100.risk.ap.team.domain.hibernate.dv">
    <class name="EvaluationView" table="x_ap_t_evaluation">
        <comment>评测系统表</comment>
        <id name="evaluationId" type="java.lang.String">
            <column name="EVALUATION_ID" length="32">
            	<comment>评测标识</comment>
            </column>
            <generator class="uuid.hex"></generator>
        </id>
        <property name="membersId" type="java.lang.String">
            <column name="MEMBERS_ID" length="32">
                <comment>成员标识</comment>
            </column>
        </property>
        <property name="interceptTotal" type="java.lang.Integer">
            <column name="INTERCEPT_TOTAL" length="7">
                <comment>拦截数量</comment>
            </column>
        </property>
        <property name="passTotal" type="java.lang.Integer">
            <column name="PASS_TOTAL" length="7">
                <comment>放行数量</comment>
            </column>
        </property>
        <property name="errorTotal" type="java.lang.Integer">
            <column name="ERROR_TOTAL" length="7">
                <comment>错误数量</comment>
            </column>
        </property>
        <property name="exactnessTotal" type="java.lang.Integer">
            <column name="EXACTNESS_TOTAL" length="7">
                <comment>正确数量</comment>
            </column>
        </property>
        <property name="createDate" type="java.util.Date">
            <column name="CREATE_DATE" length="7">
                <comment>创建日期</comment>
            </column>
        </property>
    </class>
    <!-- 查询上一次的成绩 -->
    <sql-query name="com.mp100.risk.ap.team.domain.hibernate.dv.queryEvaluationViewLastDV">
       <return alias="EvaluationView" class="com.mp100.risk.ap.team.domain.hibernate.dv.EvaluationView"></return>
     <![CDATA[
     		select 
     			EVALUATION_ID,
				'' MEMBERS_ID,
				'0' INTERCEPT_TOTAL,
				'0' PASS_TOTAL,
				'0' ERROR_TOTAL,
				EXACTNESS_TOTAL,
				'' CREATE_DATE
     		from
				(select 
						EVALUATION_ID,
						MEMBERS_ID,
						INTERCEPT_TOTAL,
						PASS_TOTAL,
						ERROR_TOTAL,
						EXACTNESS_TOTAL,
						CREATE_DATE
				from    
						x_ap_t_evaluation
				order by 
						CREATE_DATE	desc)	
			where 
					MEMBERS_ID =:QT_membersId
					and (rownum=1)			     				
      ]]>
    </sql-query>
    
    <!-- 查询出最好的成绩 -->
    <sql-query name="com.mp100.risk.ap.team.domain.hibernate.dv.queryEvaluationViewBestDV">
       <return alias="EvaluationView" class="com.mp100.risk.ap.team.domain.hibernate.dv.EvaluationView"></return>
     <![CDATA[
     		select 
     			EVALUATION_ID,
				'' MEMBERS_ID,
				'0' INTERCEPT_TOTAL,
				'0' PASS_TOTAL,
				'0' ERROR_TOTAL,
				EXACTNESS_TOTAL,
				'' CREATE_DATE
			from
				(select 
						EVALUATION_ID,
						MEMBERS_ID,
						INTERCEPT_TOTAL,
						PASS_TOTAL,
						ERROR_TOTAL,
						(select max(EXACTNESS_TOTAL) from x_ap_t_evaluation)  EXACTNESS_TOTAL,
						CREATE_DATE
				from    
						x_ap_t_evaluation)	
			where  
					MEMBERS_ID =:QT_membersId
					and (rownum=1)			     				
      ]]>
    </sql-query>
    
    <!--查询该成员中的错题集  -->
    <sql-query name="com.mp100.risk.ap.team.domain.hibernate.dv.queryEvaluationViewErrorDV">
       <return alias="EvaluationView" class="com.mp100.risk.ap.team.domain.hibernate.dv.EvaluationView"></return>
     <![CDATA[
     		select 
     			sys_guid() EVALUATION_ID,
				'' MEMBERS_ID,
				'0' INTERCEPT_TOTAL,
				'0' PASS_TOTAL,
				nvl(sum(ERROR_TOTAL),0) as ERROR_TOTAL,
				nvl(sum(EXACTNESS_TOTAL),0) as EXACTNESS_TOTAL,
				'' CREATE_DATE
			from
				x_ap_t_evaluation
			 where 
			 	MEMBERS_ID =:QT_membersId
					     				
      ]]>
    </sql-query>
</hibernate-mapping>
