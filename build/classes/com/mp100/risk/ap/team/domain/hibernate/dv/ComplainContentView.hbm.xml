<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- 
    Mapping file autogenerated by MyEclipse Persistence Tools
-->
<hibernate-mapping package="com.mp100.risk.ap.team.domain.hibernate.dv">
    <class name="ComplainContentView" table="x_ap_complain_content">
        <comment>投诉内容表</comment>
       <id name="complainId" type="java.lang.String">
            <column name="COMPLAIN_ID" length="32">
            	<comment>投诉标识</comment>
            </column>
            <generator class="uuid.hex"></generator>
        </id>
        <property name="complainPhone" type="java.lang.String">
            <column name="COMPLAIN_PHONE" length="32">
                <comment>投诉号码</comment>
            </column>
        </property>
        <property name="complainPort" type="java.lang.String">
            <column name="COMPLAIN_PORT" length="32">
                <comment>投诉端口</comment>
            </column>
        </property>
        <property name="complainContent" type="java.lang.String">
            <column name="COMPLAIN_CONTENT" length="1000">
                <comment>投诉内容</comment>
            </column>
        </property>
        <property name="complainDate" type="java.lang.String">
            <column name="COMPLAIN_DATE" length="50">
                <comment>投诉时间</comment>
            </column>
        </property>
        <property name="auditDate" type="java.util.Date">
            <column name="AUDIT_DATE" length="10">
                <comment>审核时间</comment>
            </column>
        </property>
        <property name="membersId" type="java.lang.String">
            <column name="MEMBERS_ID" length="32">
                <comment>审核人</comment>
            </column>
        </property>
        <property name="state" type="java.lang.String">
            <column name="STATE" length="20">
                <comment>状态</comment>
            </column>
        </property>
         <property name="backTrace" type="java.lang.String">
            <column name="BACKTRACE" length="10">
                <comment>是否回溯（01 已回溯 00 未回溯）</comment>
            </column>
        </property>
    </class>
    <sql-query name="com.mp100.risk.ap.team.domain.hibernate.dv.queryComplainContentViewDV">
       <return alias="ComplainContentView" class="com.mp100.risk.ap.team.domain.hibernate.dv.ComplainContentView"></return>
     <![CDATA[
			select 
					COMPLAIN_ID,
					COMPLAIN_PHONE,
					COMPLAIN_PORT,
					COMPLAIN_CONTENT,
					COMPLAIN_DATE,
					AUDIT_DATE,
					MEMBERS_ID,
					STATE,
					BACKTRACE
			from 
					x_ap_complain_content		
			where 
					MEMBERS_ID like :QT_membersId
					and BACKTRACE = '01'
					and (COMPLAIN_PHONE like :QT_mobile or :QT_mobile is null)
					and (COMPLAIN_PORT like :QT_port or :QT_port is null)
					and (COMPLAIN_CONTENT like :QT_content or :QT_content is null)
					and (to_char(to_date(COMPLAIN_DATE,'yyyy-MM-dd hh24:mi:ss'),'yyyyMM') = :QD_month)
      ]]>
    </sql-query>
    
     <sql-query name="com.mp100.risk.ap.team.domain.hibernate.dv.queryComplainContentListViewDV">
       <return alias="ComplainContentView" class="com.mp100.risk.ap.team.domain.hibernate.dv.ComplainContentView"></return>
     <![CDATA[
			select 
					COMPLAIN_ID,
					COMPLAIN_PHONE,
					COMPLAIN_PORT,
					COMPLAIN_CONTENT,
					COMPLAIN_DATE,
					AUDIT_DATE,
					MEMBERS_ID,
					STATE,
					BACKTRACE
			from 
					x_ap_complain_content		
			where 
					(COMPLAIN_PHONE like :QT_mobile or :QT_mobile is null)
					and (COMPLAIN_PORT like :QT_port or :QT_port is null)
					and (COMPLAIN_CONTENT like :QT_content or :QT_content is null)
					and (to_char(to_date(COMPLAIN_DATE,'yyyy-MM-dd hh24:mi:ss'),'yyyyMM') = :QD_month)
      ]]>
    </sql-query>
    
    <sql-query name="com.mp100.risk.ap.team.domain.hibernate.dv.queryComplainBackViewDV">
       <return alias="ComplainContentView" class="com.mp100.risk.ap.team.domain.hibernate.dv.ComplainContentView"></return>
     <![CDATA[
			select 
					COMPLAIN_ID,
					COMPLAIN_PHONE,
					COMPLAIN_PORT,
					COMPLAIN_CONTENT,
					COMPLAIN_DATE,
					AUDIT_DATE,
					MEMBERS_ID,
					STATE,
					BACKTRACE
			from 
					x_ap_complain_content		
			where 
					COMPLAIN_PHONE like :QT_mobile or :QT_mobile is null
					and (COMPLAIN_PORT like :QT_port or :QT_port is null)
					and (to_char(to_date(COMPLAIN_DATE,'yyyy-MM-dd hh24:mi:ss'),'yyyyMM') = :QD_month)
      ]]>
    </sql-query>
    
    <sql-query name="com.mp100.risk.ap.team.domain.hibernate.dv.queryListViewDV">
       <return alias="ComplainContentView" class="com.mp100.risk.ap.team.domain.hibernate.dv.ComplainContentView"></return>
     <![CDATA[
			select 
					COMPLAIN_ID,
					COMPLAIN_PHONE,
					COMPLAIN_PORT,
					COMPLAIN_CONTENT,
					COMPLAIN_DATE,
					AUDIT_DATE,
					MEMBERS_ID,
					STATE,
					BACKTRACE
			from 
					x_ap_complain_content		
			where
					BACKTRACE='00'
					and rownum <= 100
			order by 
					COMPLAIN_DATE	desc			
					
      ]]>
    </sql-query>
    <!-- 查询每个月每个人的审核总量 -->
    <sql-query name="com.mp100.risk.ap.team.domain.hibernate.dv.queryTotalNumDV">
       <return alias="ComplainContentView" class="com.mp100.risk.ap.team.domain.hibernate.dv.ComplainContentView"></return>
     <![CDATA[
			select 
					sys_guid() COMPLAIN_ID,
					'' COMPLAIN_PHONE,
					count(c.MEMBERS_ID) as COMPLAIN_PORT,
					'' COMPLAIN_CONTENT,
					to_char(to_date(c.COMPLAIN_DATE,'yyyy-MM-dd hh24:mi:ss'),'yyyyMM') as COMPLAIN_DATE,
					'' AUDIT_DATE,
					c.MEMBERS_ID,
					'' STATE,
					'' BACKTRACE
			from 
					x_ap_complain_content c, x_ap_members m
			where 
         	 		c.MEMBERS_ID = m.MEMBERS_ID
          			and (to_char(to_date(c.COMPLAIN_DATE,'yyyy-MM-dd hh24:mi:ss'),'yyyyMM') in (:QD_month))
      		group by
          			to_char(to_date(c.COMPLAIN_DATE,'yyyy-MM-dd hh24:mi:ss'),'yyyyMM'),c.MEMBERS_ID			
					
      ]]>
    </sql-query>
    <!-- 查询每个月每个人的投诉总量 -->
    <sql-query name="com.mp100.risk.ap.team.domain.hibernate.dv.queryComplaintNumDV">
       <return alias="ComplainContentView" class="com.mp100.risk.ap.team.domain.hibernate.dv.ComplainContentView"></return>
     <![CDATA[
			select 
					sys_guid() COMPLAIN_ID,
					'' COMPLAIN_PHONE,
					count(c.MEMBERS_ID) as COMPLAIN_PORT,
					'' COMPLAIN_CONTENT,
					to_char(to_date(c.COMPLAIN_DATE,'yyyy-MM-dd hh24:mi:ss'),'yyyyMM') as COMPLAIN_DATE,
					'' AUDIT_DATE,
					c.MEMBERS_ID,
					'' STATE,
					'' BACKTRACE
			from 
					x_ap_complain_content c, x_ap_members m
			where 
          			c.MEMBERS_ID = m.MEMBERS_ID
          			and (to_char(to_date(c.COMPLAIN_DATE,'yyyy-MM-dd hh24:mi:ss'),'yyyyMM') in (:QD_months))
      		group by
          			to_char(to_date(c.COMPLAIN_DATE,'yyyy-MM-dd hh24:mi:ss'),'yyyyMM'),c.MEMBERS_ID		
					
      ]]>
    </sql-query>
</hibernate-mapping>
